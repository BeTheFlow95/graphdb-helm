{{ if or (ne $.Values.graphdb.workers.persistence.storageClassName "standard") (ne $.Values.graphdb.workers.persistence.storageClassName "") }}
{{ if ne .Values.graphdb.topology "standalone" }}
{{ if eq .Values.graphdb.workers.persistence.volumeNamePrefix "graphdb-default-worker" }}
{{ range $i, $worker_index := untilStep 1 (add1 $.Values.graphdb.clusterConfig.workersCount | int ) 1 }}
#
# Default persistence volume for GraphDB workers. Data is stored on the node file system. Suitable
# for Minikube deployments.
#
# Note: Not to be used in production or multi node cluster.
#
---
apiVersion: {{ $.Values.versions.pv }}
kind: PersistentVolume
metadata:
  name: graphdb-default-worker-{{ $worker_index }}-pv
  labels:
    name: graphdb-default-worker-{{ $worker_index }}-pv
spec:
  storageClassName: {{ $.Values.graphdb.workers.persistence.storageClassName }}
  accessModes:
    - ReadWriteOnce
  capacity:
    storage: {{ $.Values.graphdb.workers.persistence.storage }}
  hostPath:
    path: {{ $.Values.deployment.storage }}/graphdb-worker-{{ $worker_index }}-data

{{ end }}
{{ end }}
{{ end }}
{{ end }}
